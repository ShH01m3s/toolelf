# Clutch

CUI/GUI: CUI
Domain: appsec, forensics, pentest
FUC: capinfos mycapture.pcap
Keywords: free, ios, ios-decrypt, ram
OS: ios

Follow the instructionsÂ [here](https://github.com/KJCracks/Clutch). I tried building it myself both ways but neither works on iOS 13.4.1 iPad Air 2. The previous version (2.0.3) works, however, it throws some errors. Trying to runÂ `inject /usr/bin/Clutch`Â resulted in broken jb and I had to boot with the volume up key pressed to flush and then - rejailbreak.

### Install:

*`# prerequisites*
xcode-select --install

*# disable SDK code signing requirement*
killall Xcode
cp /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/SDKSettings.plist ~/
sudo /usr/libexec/PlistBuddy -c "Set :DefaultProperties:CODE_SIGNING_REQUIRED NO" /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/SDKSettings.plist
sudo /usr/libexec/PlistBuddy -c "Set :DefaultProperties:AD_HOC_CODE_SIGNING_ALLOWED YES" /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/SDKSettings.plist

*# build. Option 1*
xcodebuild clean build

*# build. Option 2*
mkdir build
cd build
cmake -DCMAKE_BUILD_TYPE**=**Release -DCMAKE_TOOLCHAIN_FILE**=**../cmake/iphoneos.toolchain.cmake ..
make -j**$(**sysctl -n hw.logicalcpu**)***# install on iDevice*
scp ./build/Clutch root@**[**iDevice.ip**]**:/usr/bin/Clutch`

> âŒ Error:Â Segmentation error 11Â ğŸ¤” Why? Somewhere there is a memory access violation like a buffer is to be overflow.Â âœ… Fix 1: tryÂ ulimit -n 512Â on iDevice before launchingÂ clutchÂ âœ… Fix 2: LaunchÂ clutchÂ withÂ rootÂ âœ… Fix 3. Try older version

For installation steps seeÂ [here](https://bakerst221b.com/docs/toolkit/mobile/mobile-analysis-lab/#clutch). For usage seeÂ [here](https://bakerst221b.com/docs/toolkit/mobile/ios-btfm-rtfm/#decrypting-application). Works on its own. Doesnâ€™t laucnch the application.

Doesnâ€™t decrypt everything. Also couldnâ€™t properly install the latest version.

To ensure that the binary was decrypted, I ran:

`rabin2 -I **[**my_decrypted_binary**]** | grep "crypto"
rabin2 -I **[**my_encrypted_binary**]** | grep "crypto"`

The first one isÂ `/var/tmp/clutch/GUID/[Bundle_name]/bundle_name`Â and the second isÂ `/var/containers/Bundle/Application/[GUID]/[Bundle_name]/bundle_name`.

In my case,Â **rabin2**Â (rabin usageÂ [here](https://bakerst221b.com/docs/toolkit/general/reverse-btfm#rabin2)Â andÂ [here](https://bakerst221b.com/docs/blog/2020/09/how-i-met-radare2/)) detected both to be validÂ `Mach-O`Â files (which is an equivalent to PE on Windows systems) and the first one wasÂ `crypto true`Â while the second -Â `crypto false`.

> NB! The strings appear to be unencrypted. So, you can retrieve strings withÂ rabin2 -z [my_encrypted_binary]Â . Also, the compilation flags are not affected.

Also, we can test withÂ **r2**Â disassembler to see whether there was any difference.

`r2 **[**my_decrypted_binary**]** *# can be disassembled*
r2 **[**my_encrypted_binary**]** *# can't be disassembled*`